<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TramiFacil</title>
  <style>
    /* Todos los estilos originales se mantienen igual */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f5f5f5;
      color: #333;
      position: relative;
    }

    header {
      background-color: #004aad;
      color: white;
      padding: 20px;
      text-align: center;
      position: relative;
    }

    /* ... (todos los demás estilos originales se mantienen igual) ... */

    /* Estilos adicionales para la nueva sección de trámites */
    #contenedor-tramites {
      background: white;
      padding: 20px;
      margin: 30px 0;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .tramite-item {
      border-bottom: 1px solid #eee;
      padding: 15px 0;
    }

    .tramite-item:last-child {
      border-bottom: none;
    }

    .error {
      color: #d32f2f;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <!-- Todo el contenido HTML original se mantiene igual -->
  <header>
    <div class="header-content">
      <h1>TramiFacil</h1>
      <p>Your guide to simple and fast legal procedures</p>
      
      <div class="procedure-selector">
        <select id="procedureSelector" onchange="navigateToProcedure()">
          <option value="" selected disabled>Find your procedure...</option>
          <option value="#transfer-vehicle">Vehicle ownership transfer</option>
          <option value="#cadastral-certificate">Cadastral certificate</option>
          <option value="#irs-certificate">Tax clearance certificate</option>
          <option value="#lease-contract">Lease contract registration</option>
          <option value="#criminal-record">Criminal record certificate</option>
        </select>
      </div>
      
      <div class="header-buttons">
        <button class="header-btn" onclick="location.href='#simulators'">
          Step-by-Step Simulators
        </button>
        <button class="header-btn blue" onclick="location.href='#forms'">
          Updated Forms
        </button>
      </div>
    </div>
  </header>

  <main>
    <!-- Todas las secciones originales se mantienen -->
    <section id="simulators">
      <!-- Contenido original -->
    </section>

    <!-- ... otras secciones originales ... -->

    <!-- Nueva sección para mostrar trámites cargados desde JSON -->
    <section id="contenedor-tramites">
      <h2>Trámites Municipales</h2>
      <!-- Los trámites se cargarán aquí dinámicamente -->
    </section>

    <!-- El resto del contenido original continúa -->
    <section class="accordion">
      <!-- Contenido original -->
    </section>

    <section class="ad-space">
      <!-- Contenido original -->
    </section>

    <section class="db-admin" id="dbAdmin">
      <!-- Contenido original -->
    </section>
  </main>

  <!-- Chatbot Container (original) -->
  <div class="chatbot-container" id="chatbotContainer">
    <!-- Contenido original -->
  </div>

  <!-- Floating button (original) -->
  <button class="floating-btn" onclick="toggleChatbot()">
    Legal Assistant
  </button>

  <footer>
    <p>© 2025 TramiFacil. All rights reserved.</p>
  </footer>

  <!-- Script original completo -->
  <script>
    // 1. BASE DE DATOS (IndexedDB) - Original
    let db;
    const DB_NAME = "TramiFacilKnowledge";
    const DB_VERSION = 1;
    const STORE_NAME = "legalProcedures";

    function initDB() {
      return new Promise((resolve, reject) => {
        const request = indexedDB.open(DB_NAME, DB_VERSION);
        
        request.onupgradeneeded = (event) => {
          db = event.target.result;
          if (!db.objectStoreNames.contains(STORE_NAME)) {
            const store = db.createObjectStore(STORE_NAME, { keyPath: "id", autoIncrement: true });
            store.createIndex("procedureType", "procedureType", { unique: false });
          }
        };

        request.onsuccess = (event) => {
          db = event.target.result;
          resolve(db);
          loadKnowledgeItems();
        };

        request.onerror = (event) => {
          console.error("Database error:", event.target.error);
          reject(event.target.error);
        };
      });
    }

    // ... (todas las demás funciones originales se mantienen igual) ...

    // 5. INITIALIZATION - Original
    document.addEventListener("DOMContentLoaded", async () => {
      await initDB();
    });
  </script>

  <!-- Nuevo script para cargar trámites (se añade sin modificar el original) -->
  <script>
    async function cargarTramites() {
      try {
        const respuesta = await fetch("datos.json");
        if (!respuesta.ok) throw new Error("Error al cargar datos");
        
        const tramites = await respuesta.json();
        const contenedor = document.getElementById("contenedor-tramites");

        tramites.forEach(tramite => {
          const div = document.createElement("div");
          div.className = "tramite-item";
          div.innerHTML = `<h3>${tramite.titulo}</h3><p>${tramite.contenido}</p>`;
          contenedor.appendChild(div);
        });
      } catch (error) {
        console.error("Error:", error);
        document.getElementById("contenedor-tramites").innerHTML += 
          `<p class="error">No se pudieron cargar los trámites. Intente más tarde.</p>`;
      }
    }

    // Llama a la función después de que se cargue el DOM
    document.addEventListener("DOMContentLoaded", cargarTramites);
  </script>
</body>
</html>
